webpackJsonp([15],{AMIk:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:function(){var e=this;return{state:0,role_id:"",formValidate:{name:"",gender:"",desc:"",interest:[]},poist:[],ruleValidate:{name:[{required:!0,message:"The name cannot be empty",trigger:"blur"}],gender:[{required:!0,message:"Please select gender",trigger:"change"}],desc:[{required:!0,message:"The name cannot be empty",trigger:"blur"}],interest:[{required:!0,type:"array",min:1,message:"Choose at least one hobby",trigger:"change"}]},modal1:!1,pag:1,loading2:!0,loading1:!0,total:0,columns1:[{title:"ID",key:"role_id"},{title:"职位名称",key:"role_name"},{title:"角色状态",key:"role_isshow",render:function(e,t){return 0===t.row.role_isshow?e("div",[e("p",{},"启用")]):e("div",[e("p",{},"禁用")])}},{title:"权限描述",key:"role_desc"},{title:"操作",align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){var t=e;t.state=1,t.role_id=a.row.role_id,t.Axios.post("https://app.gsfzd.com/index.php/admin/role/update1 ",t.Qs.stringify({role_id:a.row.role_id})).then(function(e,r){var o=e.data.data;t.formValidate.interest=[];for(var i=0;i<o.length;i++)t.formValidate.interest.push(String(o[i].node_id+","+o[i].node_pid));t.formValidate.name=a.row.role_name,t.formValidate.gender=String(a.row.role_isshow),t.formValidate.desc=a.row.role_desc,t.modal1=!0})}}},"修改"),t("Poptip",{props:{confirm:!0,transfer:!0,title:"是否继续删除该职位?"},on:{"on-ok":function(){var t=e;t.Axios.post("https://app.gsfzd.com/index.php/admin/role/del",t.Qs.stringify({role_id:a.row.role_id})).then(function(e,a){0===e.data.error?(t.positList(),t.$refs.formValidate.resetFields()):t.$Message.error(e.data.errMsg)})}}},[t("Button",{props:{type:"error",size:"small"}},"删除")])])}}],data1:[]}},methods:{shoale:function(){this.state=0,this.modal1=!0,this.loading1=!0},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=t;console.log(a.formValidate.interest);for(var r=String(a.formValidate.interest).split(","),o=[],i=0;i<r.length;i++)-1===o.indexOf(r[i])&&o.push(r[i]);a.Axios.post("https://app.gsfzd.com/index.php/admin/role/add",a.Qs.stringify({role_id:0===a.state?"":a.role_id,role_name:a.formValidate.name,role_isshow:a.formValidate.gender,role_desc:a.formValidate.desc,node_id:String(o)})).then(function(e,t){0===e.data.error?(a.modal1=!1,a.positList(),a.$refs.formValidate.resetFields()):a.$Message.error(e.data.errMsg),a.$refs.formValidate.resetFields()})}else t.$Message.error("Fail!"),t.loading1=!1})},quanx:function(){var e=this;e.Axios.post("https://app.gsfzd.com/index.php/admin/role/index1").then(function(t,a){0===t.data.error?e.poist=t.data.data:e.$Message.error(t.data.errMsg)})},positList:function(){var e=this;e.loading2=!0,e.Axios.post("https://app.gsfzd.com/index.php/admin/role/index",e.Qs.stringify({pag:e.pag,num:11})).then(function(t,a){e.loading2=!1,0===t.data.error?(e.data1=t.data.data.info,e.total=t.data.data.nodes):e.$Message.error(t.data.errMsg)})},page:function(e){this.pag=e,this.positList()},cancel:function(){this.$Message.info("你点击了取消"),this.$refs.formValidate.resetFields()}},mounted:function(){this.quanx(),this.positList()}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Layout",{style:{padding:"0 24px 24px"}},[a("Breadcrumb",{style:{margin:"24px 0"}},[a("BreadcrumbItem",[e._v("职位管理")])],1),e._v(" "),a("Content",{style:{padding:"24px",minHeight:"280px",background:"#fff"}},[a("Button",{staticStyle:{"margin-bottom":"15px"},attrs:{type:"primary"},on:{click:function(t){e.shoale()}}},[a("Icon",{attrs:{type:"md-add"}}),e._v("\n      添加职位\n    ")],1),e._v(" "),a("Table",{attrs:{loading:e.loading2,columns:e.columns1,data:e.data1,height:"568",border:""}})],1),e._v(" "),a("div",{staticStyle:{float:"left",width:"100%","text-align":"center","margin-top":"25px"}},[a("Page",{attrs:{total:e.total,"page-size":11},on:{"on-change":e.page}})],1),e._v(" "),a("Modal",{attrs:{title:"请认真填写添加职位信息",loading:e.loading1,styles:{width:"600px"}},on:{"on-ok":function(t){e.handleSubmit("formValidate")},"on-cancel":e.cancel},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":80}},[a("FormItem",{attrs:{label:"职位名称",prop:"name"}},[a("Input",{attrs:{placeholder:"Enter your name"},model:{value:e.formValidate.name,callback:function(t){e.$set(e.formValidate,"name",t)},expression:"formValidate.name"}})],1),e._v(" "),a("FormItem",{attrs:{label:"权限状态",prop:"gender"}},[a("RadioGroup",{model:{value:e.formValidate.gender,callback:function(t){e.$set(e.formValidate,"gender",t)},expression:"formValidate.gender"}},[a("Radio",{attrs:{label:"0"}},[e._v("启用")]),e._v(" "),a("Radio",{attrs:{label:"1"}},[e._v("禁用")])],1)],1),e._v(" "),a("FormItem",{attrs:{label:"职位描述",prop:"desc"}},[a("Input",{attrs:{placeholder:"Enter your name"},model:{value:e.formValidate.desc,callback:function(t){e.$set(e.formValidate,"desc",t)},expression:"formValidate.desc"}})],1),e._v(" "),a("FormItem",{staticStyle:{height:"400px","overflow-x":"auto"},attrs:{label:"拥有权限",prop:"interest"}},[a("CheckboxGroup",{model:{value:e.formValidate.interest,callback:function(t){e.$set(e.formValidate,"interest",t)},expression:"formValidate.interest"}},e._l(e.poist,function(t,r){return a("div",{staticStyle:{"margin-bottom":"15px"}},[a("p",{staticStyle:{color:"#000","font-size":"13px"}},[e._v(e._s(t.node_name))]),e._v(" "),e._l(t.son,function(t,r){return a("Checkbox",{key:r,attrs:{label:t.node_id+","+t.node_pid}},[e._v("\n              "+e._s(t.node_name)+"\n            ")])})],2)}))],1)],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(r,o,!1,function(e){a("q2d5")},null,null);t.default=i.exports},q2d5:function(e,t){}});
//# sourceMappingURL=15.e09c97b212ab83f1efb4.js.map