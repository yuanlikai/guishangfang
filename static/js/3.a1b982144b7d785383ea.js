webpackJsonp([3],{"55om":function(e,t){},OIdX:function(e,t){},"sS/j":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("mvHQ"),i=n.n(a),o={data:function(){return{defaultList:[],imgName:"",visible:!1,uploadList:[]}},methods:{handleView:function(e){this.imgName=e,this.visible=!0},handleRemove:function(e){var t=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(t.indexOf(e),1)},handleSuccess:function(e,t){console.log(e),t.url="http://img.gsfzd.com/"+e,t.name="7eb99afb9d5f317c912f08b5212fd69a"},handleFormatError:function(e){this.$Notice.warning({title:"The file format is incorrect",desc:"File format of "+e.name+" is incorrect, please select jpg or png."})},handleMaxSize:function(e){this.$Notice.warning({title:"Exceeding file size limit",desc:"File  "+e.name+" is too large, no more than 2M."})},handleBeforeUpload:function(){var e=this.uploadList.length<1;return e||this.$Notice.warning({title:"Up to five pictures can be uploaded."}),e},imgS:function(e){var t=this;t.defaultList=[{url:"http://img.gsfzd.com/"+e,name:"7eb99afb9d5f317c912f08b5212fd69a",response:e}],setTimeout(function(){t.uploadList=t.$refs.upload.fileList},0)}},mounted:function(){this.uploadList=this.$refs.upload.fileList}},s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._l(e.uploadList,function(t){return n("div",{staticClass:"demo-upload-list"},["finished"===t.status?[n("img",{attrs:{src:t.url}}),e._v(" "),n("div",{staticClass:"demo-upload-list-cover"},[n("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(n){e.handleView(t.url)}}}),e._v(" "),n("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(n){e.handleRemove(t)}}})],1)]:[t.showProgress?n("Progress",{attrs:{percent:t.percentage,"hide-info":""}}):e._e()]],2)}),e._v(" "),n("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"default-file-list":e.defaultList,"on-success":e.handleSuccess,format:["jpg","jpeg","png"],"max-size":2048,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"before-upload":e.handleBeforeUpload,multiple:"",type:"drag",action:"https://app.gsfzd.com/publics/picture/imgouter",data:{location:"news"}}},[n("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[n("Icon",{attrs:{type:"ios-camera",size:"20"}})],1),e._v(" "),n("Modal",{attrs:{title:"View Image",styles:{textAlign:"center"}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?n("img",{staticStyle:{"max-width":"100%"},attrs:{src:e.imgName}}):e._e()])],1)],2)},staticRenderFns:[]};var r={components:{unload:n("VU/8")(o,s,!1,function(e){n("OIdX")},null,null).exports},data:function(){var e=this;return{state:0,modal2:!1,news_id:"",imgSrc:"",positLi:[],formValidate:{news_headline:"",news_cover:"",news_content:[],news_ishot:"0",news_content1:"",news_content3:"",news_content4:""},poist:[],ruleValidate:{news_headline:[{required:!0,message:"请填写活动标题",trigger:"blur"}],news_cover:[{required:!0,validator:function(t,n,a){1!==e.$refs.unload1.uploadList.length?a(new Error("请上传一张图片")):a()},trigger:"change"}],news_ishot:[{required:!0,message:"请选择状态",trigger:"change"}],news_content1:[{required:!0,message:"请填写活动内容",trigger:"blur"}],news_content2:[{required:!0,validator:function(t,n,a){1!==e.$refs.unload2.uploadList.length?a(new Error("请上传一张图片")):a()},trigger:"change"}],news_content3:[{required:!0,message:"请填写活动内容",trigger:"blur"}],news_content4:[{required:!0,validator:function(t,n,a){1!==e.$refs.unload3.uploadList.length?a(new Error("请上传一张图片")):a()},trigger:"change"}],news_content5:[{required:!0,message:"请填写活动内容",trigger:"blur"}]},modal1:!1,pag:1,loading2:!0,loading1:!0,total:0,columns1:[{title:"ID",align:"center",key:"news_id",width:50},{title:"发布人",key:"admin_name"},{title:"新闻标题",key:"news_headline"},{title:"封面图",align:"center",key:"news_cover",render:function(t,n){return t("div",[t("img",{attrs:{src:"http://img.gsfzd.com/"+n.row.news_cover},style:{width:"30px",cursor:"pointer"},on:{click:function(){e.modal2=!0,e.imgSrc="http://img.gsfzd.com/"+n.row.news_cover}}})])}},{title:"状态",align:"center",key:"news_ishot",render:function(e,t){return 0===t.row.news_ishot?e("div",[e("p","不推荐")]):e("div",[e("p","推荐")])}},{title:"点击量",align:"center",key:"news_hits"},{title:"开始时间",key:"news_addtime",render:function(t,n){return t("div",[t("p",e.timestampToTime(n.row.news_addtime))])}},{title:"操作",align:"center",width:150,render:function(t,n){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){var t=e,a=JSON.parse(n.row.news_content);t.shoale(),t.state=1,t.news_id=n.row.news_id,t.formValidate.news_headline=n.row.news_headline,t.$refs.unload1.imgS(n.row.news_cover),t.formValidate.news_ishot=String(n.row.news_ishot),t.formValidate.news_content1=a.news_content1,t.$refs.unload2.imgS(a.news_content2),t.formValidate.news_content3=a.news_content3,t.$refs.unload3.imgS(a.news_content4),t.formValidate.news_content5=a.news_content5}}},"修改"),t("Poptip",{props:{confirm:!0,transfer:!0,title:"是否继续删除该banner?"},on:{"on-ok":function(){var t=e;t.Axios.post("https://app.gsfzd.com/index.php/admin/news/del",t.Qs.stringify({news_id:n.row.news_id})).then(function(e,n){0===e.data.error?t.positList():t.$Message.error(e.data.errMsg)})}}},[t("Button",{props:{type:"error",size:"small"}},"删除")])])}}],data1:[]}},methods:{shoale:function(){this.$refs.formValidate.resetFields(),this.state=0,this.modal1=!0,this.loading1=!0,this.city()},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var n=t,a=i()({news_content1:n.formValidate.news_content1,news_content2:n.$refs.unload2.uploadList[0].response,news_content3:n.formValidate.news_content3,news_content4:n.$refs.unload3.uploadList[0].response,news_content5:n.formValidate.news_content5});n.Axios.post("https://app.gsfzd.com/index.php/admin/news/add",n.Qs.stringify({news_id:1===n.state?n.news_id:"",news_headline:n.formValidate.news_headline,news_cover:n.$refs.unload1.uploadList[0].response,news_content:a,news_ishot:n.formValidate.news_ishot})).then(function(e,t){0===e.data.error?(n.modal1=!1,n.positList(),n.$refs.formValidate.resetFields()):(n.$Message.error(e.data.errMsg),n.loading1=!1)})}else t.$Message.error("添加新闻失败!"),t.loading1=!1})},city:function(){var e=this;e.Axios.post("https://app.gsfzd.com/index.php/admin/banner/city").then(function(t,n){if(0===t.data.error){e.positLi=[{areaId:0,areaName:"全部显示"}].concat(t.data.data)}else e.$Message.error(t.data.errMsg)})},positList:function(){var e=this;e.loading2=!0,e.Axios.post("https://app.gsfzd.com/index.php/admin/news/index",e.Qs.stringify({pag:e.pag,num:11})).then(function(t,n){console.log(t.data),e.loading2=!1,0===t.data.error?(e.data1=t.data.data.info,e.total=t.data.data.nodes):e.$Message.error(t.data.errMsg)})},page:function(e){this.pag=e,this.positList()},quanx:function(){var e=this;e.Axios.post("https://app.gsfzd.com/index.php/admin/role/index1").then(function(t,n){0===t.data.error?e.poist=t.data.data:e.$Message.error(t.data.errMsg)})},cancel:function(){this.$Message.info("你点击了取消")}},mounted:function(){this.quanx(),this.positList()}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Layout",{style:{padding:"0 24px 24px"}},[n("Breadcrumb",{style:{margin:"24px 0"}},[n("BreadcrumbItem",[e._v("新闻管理")])],1),e._v(" "),n("Content",{style:{padding:"24px",minHeight:"280px",background:"#fff"}},[n("Button",{staticStyle:{"margin-bottom":"15px"},attrs:{type:"primary"},on:{click:function(t){e.shoale()}}},[n("Icon",{attrs:{type:"md-add"}}),e._v("\n      添加新闻\n    ")],1),e._v(" "),n("Table",{attrs:{loading:e.loading2,columns:e.columns1,data:e.data1,height:"568",border:""}})],1),e._v(" "),n("div",{staticStyle:{float:"left",width:"100%","text-align":"center","margin-top":"25px"}},[n("Page",{attrs:{total:e.total,"page-size":11},on:{"on-change":e.page}})],1),e._v(" "),n("Modal",{attrs:{title:"请认真填写新闻信息",loading:e.loading1,styles:{width:"420px"}},on:{"on-ok":function(t){e.handleSubmit("formValidate")},"on-cancel":e.cancel},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[n("Modal",{attrs:{title:"活动主图",styles:{textAlign:"center"}},model:{value:e.modal2,callback:function(t){e.modal2=t},expression:"modal2"}},[n("img",{staticStyle:{"max-width":"100%"},attrs:{src:e.imgSrc,alt:""}})]),e._v(" "),n("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":80}},[n("FormItem",{attrs:{label:"新闻标题",prop:"news_headline"}},[n("Input",{attrs:{placeholder:"请填写新闻标题"},model:{value:e.formValidate.news_headline,callback:function(t){e.$set(e.formValidate,"news_headline",t)},expression:"formValidate.news_headline"}})],1),e._v(" "),n("FormItem",{attrs:{label:"封面图片",prop:"news_cover"}},[n("unload",{ref:"unload1"})],1),e._v(" "),n("FormItem",{attrs:{label:"状态",prop:"news_ishot"}},[n("RadioGroup",{model:{value:e.formValidate.news_ishot,callback:function(t){e.$set(e.formValidate,"news_ishot",t)},expression:"formValidate.news_ishot"}},[n("Radio",{attrs:{label:"0"}},[e._v("不推荐")]),e._v(" "),n("Radio",{attrs:{label:"1"}},[e._v("推荐")])],1)],1),e._v(" "),n("FormItem",{attrs:{label:"新闻内容",prop:"news_content1"}},[n("Input",{attrs:{type:"textarea",rows:3,placeholder:"Enter something..."},model:{value:e.formValidate.news_content1,callback:function(t){e.$set(e.formValidate,"news_content1",t)},expression:"formValidate.news_content1"}})],1),e._v(" "),n("FormItem",{attrs:{label:"内容图片",prop:"news_content2"}},[n("unload",{ref:"unload2"})],1),e._v(" "),n("FormItem",{attrs:{label:"新闻内容",prop:"news_content3"}},[n("Input",{attrs:{type:"textarea",rows:3,placeholder:"Enter something..."},model:{value:e.formValidate.news_content3,callback:function(t){e.$set(e.formValidate,"news_content3",t)},expression:"formValidate.news_content3"}})],1),e._v(" "),n("FormItem",{attrs:{label:"内容图片",prop:"news_content4"}},[n("unload",{ref:"unload3"})],1),e._v(" "),n("FormItem",{attrs:{label:"新闻内容",prop:"news_content5"}},[n("Input",{attrs:{type:"textarea",rows:3,placeholder:"Enter something..."},model:{value:e.formValidate.news_content5,callback:function(t){e.$set(e.formValidate,"news_content5",t)},expression:"formValidate.news_content5"}})],1)],1)],1)],1)},staticRenderFns:[]};var d=n("VU/8")(r,l,!1,function(e){n("55om")},null,null);t.default=d.exports}});
//# sourceMappingURL=3.a1b982144b7d785383ea.js.map