webpackJsonp([9],{ig5o:function(t,e){},nKfX:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={data:function(){var t=this;return{defaultList:[],imgName:"",visible:!1,uploadList:[],state:0,modal2:!1,imgSrc:"",banner_id:"",positLi:[],formValidate:{city:"",img:""},poist:[],ruleValidate:{city:[{required:!0,message:"请选择地区!",trigger:"change"}],img:[{required:!0,validator:function(e,i,a){1!==t.uploadList.length?a(new Error("请选择1张图片")):a()},trigger:"change"}]},modal1:!1,pag:1,loading2:!0,loading1:!0,total:0,columns1:[{title:"ID",align:"center",key:"banner_id",width:50},{title:"图片",align:"center",key:"banner_url",render:function(e,i){return e("div",[e("img",{attrs:{src:"http://img.gsfzd.com/"+i.row.banner_url},style:{width:"30px",cursor:"pointer"},on:{click:function(){t.modal2=!0,t.imgSrc="http://img.gsfzd.com/"+i.row.banner_url}}})])}},{title:"显示地区",align:"center",render:function(t,e){return 0===e.row.city_id?[t("p","全部显示")]:[t("p",e.row.areaName)]}},{title:"操作",align:"center",render:function(e,i){return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){var e=t;e.shoale(),e.state=1,e.banner_id=i.row.banner_id,e.formValidate.city=String(i.row.city_id),e.defaultList=[{name:"bc7521e033abdd1e92222d733590f104",url:"http://img.gsfzd.com/"+i.row.banner_url}],setTimeout(function(){e.uploadList=e.$refs.upload.fileList},0)}}},"修改"),e("Poptip",{props:{confirm:!0,transfer:!0,title:"是否继续删除该banner?"},on:{"on-ok":function(){var e=t;e.Axios.post("https://app.gsfzd.com/index.php/admin/banner/del",e.Qs.stringify({banner_id:i.row.banner_id})).then(function(t,i){0===t.data.error?e.positList():e.$Message.error(t.data.errMsg)})}}},[e("Button",{props:{type:"error",size:"small"}},"删除")])])}}],data1:[]}},methods:{handleView:function(t){this.imgName=t,this.visible=!0},handleRemove:function(t){this.$refs.upload.fileList;this.$refs.upload.fileList.splice(0,1)},handleSuccess:function(t,e){e.url="http://img.gsfzd.com/"+t,e.name="7eb99afb9d5f317c912f08b5212fd69a"},handleFormatError:function(t){this.$Notice.warning({title:"The file format is incorrect",desc:"File format of "+t.name+" is incorrect, please select jpg or png."})},handleMaxSize:function(t){this.$Notice.warning({title:"Exceeding file size limit",desc:"File  "+t.name+" is too large, no more than 2M."})},handleBeforeUpload:function(){var t=this.uploadList.length<1;return t||this.$Notice.warning({title:"Up to five pictures can be uploaded."}),t},shoale:function(){this.$refs.formValidate.resetFields(),this.state=0,this.modal1=!0,this.loading1=!0,this.city()},handleSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(t){var i=e;i.Axios.post("https://app.gsfzd.com/index.php/admin/banner/add",i.Qs.stringify({banner_id:0===i.state?"":i.banner_id,banner_url:i.uploadList[0].response,city_id:i.formValidate.city})).then(function(t,e){0===t.data.error?(i.modal1=!1,i.positList(),i.$refs.formValidate.resetFields(),i.$refs.upload.fileList.splice(0,1)):(i.$Message.error(t.data.errMsg),i.loading1=!1)})}else e.$Message.error("添加banner失败!"),e.loading1=!1})},city:function(){var t=this;t.Axios.post("https://app.gsfzd.com/index.php/admin/banner/city").then(function(e,i){if(0===e.data.error){t.positLi=[{areaId:0,areaName:"全部显示"}].concat(e.data.data)}else t.$Message.error(e.data.errMsg)})},positList:function(){var t=this;t.loading2=!0,t.Axios.post("https://app.gsfzd.com/index.php/admin/banner/index",t.Qs.stringify({pag:t.pag,num:11})).then(function(e,i){t.loading2=!1,0===e.data.error?(t.data1=e.data.data.info,t.total=e.data.data.nodes):t.$Message.error(e.data.errMsg)})},page:function(t){this.pag=t,this.positList()},quanx:function(){var t=this;t.Axios.post("https://app.gsfzd.com/index.php/admin/role/index1").then(function(e,i){0===e.data.error?t.poist=e.data.data:t.$Message.error(e.data.errMsg)})},cancel:function(){this.$Message.info("你点击了取消"),this.$refs.upload.fileList.splice(0,1)}},mounted:function(){this.uploadList=this.$refs.upload.fileList,this.quanx(),this.positList()}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Layout",{style:{padding:"0 24px 24px"}},[i("Breadcrumb",{style:{margin:"24px 0"}},[i("BreadcrumbItem",[t._v("轮播图管理")])],1),t._v(" "),i("Content",{style:{padding:"24px",minHeight:"280px",background:"#fff"}},[i("Button",{staticStyle:{"margin-bottom":"15px"},attrs:{type:"primary"},on:{click:function(e){t.shoale()}}},[i("Icon",{attrs:{type:"md-add"}}),t._v("\n      添加banner\n    ")],1),t._v(" "),i("Table",{attrs:{loading:t.loading2,columns:t.columns1,data:t.data1,height:"568",border:""}})],1),t._v(" "),i("div",{staticStyle:{float:"left",width:"100%","text-align":"center","margin-top":"25px"}},[i("Page",{attrs:{total:t.total,"page-size":11},on:{"on-change":t.page}})],1),t._v(" "),i("Modal",{attrs:{title:"轮播图图片",styles:{textAlign:"center"}},model:{value:t.modal2,callback:function(e){t.modal2=e},expression:"modal2"}},[i("img",{staticStyle:{"max-width":"100%"},attrs:{src:t.imgSrc,alt:""}})]),t._v(" "),i("Modal",{attrs:{title:"请认真填写banner",loading:t.loading1,styles:{width:"420px"}},on:{"on-ok":function(e){t.handleSubmit("formValidate")},"on-cancel":t.cancel},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[i("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":80}},[i("FormItem",{attrs:{label:"选择地区",prop:"city"}},[i("Select",{attrs:{placeholder:"Select your position"},model:{value:t.formValidate.city,callback:function(e){t.$set(t.formValidate,"city",e)},expression:"formValidate.city"}},t._l(t.positLi,function(e,a){return i("Option",{key:a,attrs:{value:String(e.areaId)}},[t._v(t._s(e.areaName)+"\n          ")])}))],1),t._v(" "),i("FormItem",{attrs:{label:"图片上传",prop:"img"}},[t._l(t.uploadList,function(e){return i("div",{staticClass:"demo-upload-list"},["finished"===e.status?[i("img",{attrs:{src:e.url}}),t._v(" "),i("div",{staticClass:"demo-upload-list-cover"},[i("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(i){t.handleView(e.url)}}},[t._v(t._s(e.name))]),t._v(" "),i("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(i){t.handleRemove(e)}}})],1)]:[e.showProgress?i("Progress",{attrs:{percent:e.percentage,"hide-info":""}}):t._e()]],2)}),t._v(" "),i("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"default-file-list":t.defaultList,"on-success":t.handleSuccess,format:["jpg","jpeg","png"],"max-size":2048,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"before-upload":t.handleBeforeUpload,multiple:"",type:"drag",action:"https://app.gsfzd.com/publics/picture/imgouter",data:{location:"slideshow"}}},[i("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[i("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)])],2)],1)],1),t._v(" "),i("Modal",{attrs:{title:"View Image",styles:{textAlign:"center"}},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?i("img",{staticStyle:{"max-width":"100%"},attrs:{src:t.imgName}}):t._e()])],1)},staticRenderFns:[]};var r=i("VU/8")(a,n,!1,function(t){i("ig5o")},null,null);e.default=r.exports}});
//# sourceMappingURL=9.0390d2dde9042c8ee141.js.map